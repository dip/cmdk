import{a as le}from"./chunk-NZJY6EH4.mjs";import*as w from"@radix-ui/react-dialog";import*as t from"react";import{Primitive as I}from"@radix-ui/react-primitive";import{useId as L}from"@radix-ui/react-id";var N='[cmdk-group=""]',Q='[cmdk-group-items=""]',Re='[cmdk-group-heading=""]',Z='[cmdk-item=""]',ue=`${Z}:not([aria-disabled="true"])`,Y="cmdk-item-select",M="data-value",be=(r,o,n)=>le(r,o,n),de=t.createContext(void 0),K=()=>t.useContext(de),fe=t.createContext(void 0),ee=()=>t.useContext(fe),me=t.createContext(void 0);var pe=t.forwardRef((r,o)=>{let n=k(()=>{var e,s;return{search:"",value:(s=(e=r.value)!=null?e:r.defaultValue)!=null?s:"",filtered:{count:0,items:new Map,groups:new Set}}}),u=k(()=>new Set),c=k(()=>new Map),d=k(()=>new Map),f=k(()=>new Set),p=ve(r),{label:v,children:b,value:l,onValueChange:y,filter:E,shouldFilter:C,loop:H,disablePointerSelection:te=!1,vimBindings:$=!0,...O}=r,ne=L(),B=L(),F=L(),x=t.useRef(null),R=Te();T(()=>{if(l!==void 0){let e=l.trim();n.current.value=e,h.emit()}},[l]),T(()=>{R(6,oe)},[]);let h=t.useMemo(()=>({subscribe:e=>(f.current.add(e),()=>f.current.delete(e)),snapshot:()=>n.current,setState:(e,s,i)=>{var a,m,g;if(!Object.is(n.current[e],s)){if(n.current[e]=s,e==="search")W(),U(),R(1,z);else if(e==="value"&&(i||R(5,oe),((a=p.current)==null?void 0:a.value)!==void 0)){let S=s!=null?s:"";(g=(m=p.current).onValueChange)==null||g.call(m,S);return}h.emit()}},emit:()=>{f.current.forEach(e=>e())}}),[]),q=t.useMemo(()=>({value:(e,s,i)=>{var a;s!==((a=d.current.get(e))==null?void 0:a.value)&&(d.current.set(e,{value:s,keywords:i}),n.current.filtered.items.set(e,re(s,i)),R(2,()=>{U(),h.emit()}))},item:(e,s)=>(u.current.add(e),s&&(c.current.has(s)?c.current.get(s).add(e):c.current.set(s,new Set([e]))),R(3,()=>{W(),U(),n.current.value||z(),h.emit()}),()=>{d.current.delete(e),u.current.delete(e),n.current.filtered.items.delete(e);let i=A();R(4,()=>{W(),(i==null?void 0:i.getAttribute("id"))===e&&z(),h.emit()})}),group:e=>(c.current.has(e)||c.current.set(e,new Set),()=>{d.current.delete(e),c.current.delete(e)}),filter:()=>p.current.shouldFilter,label:v||r["aria-label"],disablePointerSelection:te,listId:ne,inputId:F,labelId:B,listInnerRef:x}),[]);function re(e,s){var a,m;let i=(m=(a=p.current)==null?void 0:a.filter)!=null?m:be;return e?i(e,n.current.search,s):0}function U(){if(!n.current.search||p.current.shouldFilter===!1)return;let e=n.current.filtered.items,s=[];n.current.filtered.groups.forEach(a=>{let m=c.current.get(a),g=0;m.forEach(S=>{let P=e.get(S);g=Math.max(P,g)}),s.push([a,g])});let i=x.current;_().sort((a,m)=>{var P,V;let g=a.getAttribute("id"),S=m.getAttribute("id");return((P=e.get(S))!=null?P:0)-((V=e.get(g))!=null?V:0)}).forEach(a=>{let m=a.closest(Q);m?m.appendChild(a.parentElement===m?a:a.closest(`${Q} > *`)):i.appendChild(a.parentElement===i?a:a.closest(`${Q} > *`))}),s.sort((a,m)=>m[1]-a[1]).forEach(a=>{var g;let m=(g=x.current)==null?void 0:g.querySelector(`${N}[${M}="${encodeURIComponent(a[0])}"]`);m==null||m.parentElement.appendChild(m)})}function z(){let e=_().find(i=>i.getAttribute("aria-disabled")!=="true"),s=e==null?void 0:e.getAttribute(M);h.setState("value",s||void 0)}function W(){var s,i,a,m;if(!n.current.search||p.current.shouldFilter===!1){n.current.filtered.count=u.current.size;return}n.current.filtered.groups=new Set;let e=0;for(let g of u.current){let S=(i=(s=d.current.get(g))==null?void 0:s.value)!=null?i:"",P=(m=(a=d.current.get(g))==null?void 0:a.keywords)!=null?m:[],V=re(S,P);n.current.filtered.items.set(g,V),V>0&&e++}for(let[g,S]of c.current)for(let P of S)if(n.current.filtered.items.get(P)>0){n.current.filtered.groups.add(g);break}n.current.filtered.count=e}function oe(){var s,i,a;let e=A();e&&(((s=e.parentElement)==null?void 0:s.firstChild)===e&&((a=(i=e.closest(N))==null?void 0:i.querySelector(Re))==null||a.scrollIntoView({block:"nearest"})),e.scrollIntoView({block:"nearest"}))}function A(){var e;return(e=x.current)==null?void 0:e.querySelector(`${Z}[aria-selected="true"]`)}function _(){var e;return Array.from(((e=x.current)==null?void 0:e.querySelectorAll(ue))||[])}function J(e){let i=_()[e];i&&h.setState("value",i.getAttribute(M))}function X(e){var g;let s=A(),i=_(),a=i.findIndex(S=>S===s),m=i[a+e];(g=p.current)!=null&&g.loop&&(m=a+e<0?i[i.length-1]:a+e===i.length?i[0]:i[a+e]),m&&h.setState("value",m.getAttribute(M))}function ie(e){let s=A(),i=s==null?void 0:s.closest(N),a;for(;i&&!a;)i=e>0?Ie(i,N):Me(i,N),a=i==null?void 0:i.querySelector(ue);a?h.setState("value",a.getAttribute(M)):X(e)}let ae=()=>J(_().length-1),se=e=>{e.preventDefault(),e.metaKey?ae():e.altKey?ie(1):X(1)},ce=e=>{e.preventDefault(),e.metaKey?J(0):e.altKey?ie(-1):X(-1)};return t.createElement(I.div,{ref:o,tabIndex:-1,...O,"cmdk-root":"",onKeyDown:e=>{var s;if((s=O.onKeyDown)==null||s.call(O,e),!e.defaultPrevented)switch(e.key){case"n":case"j":{$&&e.ctrlKey&&se(e);break}case"ArrowDown":{se(e);break}case"p":case"k":{$&&e.ctrlKey&&ce(e);break}case"ArrowUp":{ce(e);break}case"Home":{e.preventDefault(),J(0);break}case"End":{e.preventDefault(),ae();break}case"Enter":if(!e.nativeEvent.isComposing&&e.keyCode!==229){e.preventDefault();let i=A();if(i){let a=new Event(Y);i.dispatchEvent(a)}}}}},t.createElement("label",{"cmdk-label":"",htmlFor:q.inputId,id:q.labelId,style:ke},v),j(r,e=>t.createElement(fe.Provider,{value:h},t.createElement(de.Provider,{value:q},e))))}),he=t.forwardRef((r,o)=>{var F,x;let n=L(),u=t.useRef(null),c=t.useContext(me),d=K(),f=ve(r),p=(x=(F=f.current)==null?void 0:F.forceMount)!=null?x:c==null?void 0:c.forceMount;T(()=>{if(!p)return d.item(n,c==null?void 0:c.id)},[p]);let v=ge(n,u,[r.value,r.children,u],r.keywords),b=ee(),l=D(R=>R.value&&R.value===v.current),y=D(R=>p||d.filter()===!1?!0:R.search?R.filtered.items.get(n)>0:!0);t.useEffect(()=>{let R=u.current;if(!(!R||r.disabled))return R.addEventListener(Y,E),()=>R.removeEventListener(Y,E)},[y,r.onSelect,r.disabled]);function E(){var R,h;C(),(h=(R=f.current).onSelect)==null||h.call(R,v.current)}function C(){b.setState("value",v.current,!0)}if(!y)return null;let{disabled:H,value:te,onSelect:$,forceMount:O,keywords:ne,...B}=r;return t.createElement(I.div,{ref:G([u,o]),...B,id:n,"cmdk-item":"",role:"option","aria-disabled":!!H,"aria-selected":!!l,"data-disabled":!!H,"data-selected":!!l,onPointerMove:H||d.disablePointerSelection?void 0:C,onClick:H?void 0:E},r.children)}),ye=t.forwardRef((r,o)=>{let{heading:n,children:u,forceMount:c,...d}=r,f=L(),p=t.useRef(null),v=t.useRef(null),b=L(),l=K(),y=D(C=>c||l.filter()===!1?!0:C.search?C.filtered.groups.has(f):!0);T(()=>l.group(f),[]),ge(f,p,[r.value,r.heading,v]);let E=t.useMemo(()=>({id:f,forceMount:c}),[c]);return t.createElement(I.div,{ref:G([p,o]),...d,"cmdk-group":"",role:"presentation",hidden:y?void 0:!0},n&&t.createElement("div",{ref:v,"cmdk-group-heading":"","aria-hidden":!0,id:b},n),j(r,C=>t.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?b:void 0},t.createElement(me.Provider,{value:E},C))))}),Se=t.forwardRef((r,o)=>{let{alwaysRender:n,...u}=r,c=t.useRef(null),d=D(f=>!f.search);return!n&&!d?null:t.createElement(I.div,{ref:G([c,o]),...u,"cmdk-separator":"",role:"separator"})}),Ee=t.forwardRef((r,o)=>{let{onValueChange:n,...u}=r,c=r.value!=null,d=ee(),f=D(l=>l.search),p=D(l=>l.value),v=K(),b=t.useMemo(()=>{var y;let l=(y=v.listInnerRef.current)==null?void 0:y.querySelector(`${Z}[${M}="${encodeURIComponent(p)}"]`);return l==null?void 0:l.getAttribute("id")},[]);return t.useEffect(()=>{r.value!=null&&d.setState("search",r.value)},[r.value]),t.createElement(I.input,{ref:o,...u,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":v.listId,"aria-labelledby":v.labelId,"aria-activedescendant":b,id:v.inputId,type:"text",value:c?r.value:f,onChange:l=>{c||d.setState("search",l.target.value),n==null||n(l.target.value)}})}),Ce=t.forwardRef((r,o)=>{let{children:n,label:u="Suggestions",...c}=r,d=t.useRef(null),f=t.useRef(null),p=K();return t.useEffect(()=>{if(f.current&&d.current){let v=f.current,b=d.current,l,y=new ResizeObserver(()=>{l=requestAnimationFrame(()=>{let E=v.offsetHeight;b.style.setProperty("--cmdk-list-height",E.toFixed(1)+"px")})});return y.observe(v),()=>{cancelAnimationFrame(l),y.unobserve(v)}}},[]),t.createElement(I.div,{ref:G([d,o]),...c,"cmdk-list":"",role:"listbox","aria-label":u,id:p.listId},j(r,v=>t.createElement("div",{ref:G([f,p.listInnerRef]),"cmdk-list-sizer":""},v)))}),xe=t.forwardRef((r,o)=>{let{open:n,onOpenChange:u,overlayClassName:c,contentClassName:d,container:f,...p}=r;return t.createElement(w.Root,{open:n,onOpenChange:u},t.createElement(w.Portal,{container:f},t.createElement(w.Overlay,{"cmdk-overlay":"",className:c}),t.createElement(w.Content,{"aria-label":r.label,"cmdk-dialog":"",className:d},t.createElement(pe,{ref:o,...p}))))}),Pe=t.forwardRef((r,o)=>D(u=>u.filtered.count===0)?t.createElement(I.div,{ref:o,...r,"cmdk-empty":"",role:"presentation"}):null),we=t.forwardRef((r,o)=>{let{progress:n,children:u,label:c="Loading...",...d}=r;return t.createElement(I.div,{ref:o,...d,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":c},j(r,f=>t.createElement("div",{"aria-hidden":!0},f)))}),Ae=Object.assign(pe,{List:Ce,Item:he,Input:Ee,Group:ye,Separator:Se,Dialog:xe,Empty:Pe,Loading:we});function Ie(r,o){let n=r.nextElementSibling;for(;n;){if(n.matches(o))return n;n=n.nextElementSibling}}function Me(r,o){let n=r.previousElementSibling;for(;n;){if(n.matches(o))return n;n=n.previousElementSibling}}function ve(r){let o=t.useRef(r);return T(()=>{o.current=r}),o}var T=typeof window=="undefined"?t.useEffect:t.useLayoutEffect;function k(r){let o=t.useRef();return o.current===void 0&&(o.current=r()),o}function G(r){return o=>{r.forEach(n=>{typeof n=="function"?n(o):n!=null&&(n.current=o)})}}function D(r){let o=ee(),n=()=>r(o.snapshot());return t.useSyncExternalStore(o.subscribe,n,n)}function ge(r,o,n,u=[]){let c=t.useRef(),d=K();return T(()=>{var v;let f=(()=>{var b;for(let l of n){if(typeof l=="string")return l.trim();if(typeof l=="object"&&"current"in l)return l.current?(b=l.current.textContent)==null?void 0:b.trim():c.current}})(),p=u.map(b=>b.trim());d.value(r,f,p),(v=o.current)==null||v.setAttribute(M,f),c.current=f}),c}var Te=()=>{let[r,o]=t.useState(),n=k(()=>new Map);return T(()=>{n.current.forEach(u=>u()),n.current=new Map},[r]),(u,c)=>{n.current.set(u,c),o({})}};function De(r){let o=r.type;return typeof o=="function"?o(r.props):"render"in o?o.render(r.props):r}function j({asChild:r,children:o},n){return r&&t.isValidElement(o)?t.cloneElement(De(o),{ref:o.ref},n(o.props.children)):n(o)}var ke={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};export{Ae as Command,xe as CommandDialog,Pe as CommandEmpty,ye as CommandGroup,Ee as CommandInput,he as CommandItem,Ce as CommandList,we as CommandLoading,pe as CommandRoot,Se as CommandSeparator,be as defaultFilter,D as useCommandState};
